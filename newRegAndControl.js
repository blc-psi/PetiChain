var Web3 = require('web3');
var web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));

// var account = process.argv[2];
// var pwd = process.argv[3];
var account = web3.eth.accounts[0];
var pwd = "1234";

if (!account) {
console.log("You didn't provide an account. Run script like 'node file account pwd' in command line");
process.exit()
}
if (!pwd) {
console.log("You didn't provide a password. Run script like 'node file account pwd' in command line");
process.exit()
}
if (!web3.isAddress(account)) {
console.log("Invalid account address");
process.exit()
}
if (!web3.personal.unlockAccount(account, pwd)) {
console.log("Account address or password are wrong or do not exist");
process.exit()
}

web3.eth.defaultAccount = account;

var controlABI = '[{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"},{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transferToken","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_petiRegister","type":"address"},{"name":"_userRegister","type":"address"},{"name":"_authRegister","type":"address"}],"name":"init","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"}],"name":"isAuth","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"}],"name":"insertAuth","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"authRegister","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"}],"name":"getToken","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"},{"name":"_to","type":"address"},{"name":"_amount","type":"uint256"}],"name":"setBalanceToken","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"initFull","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"userRegister","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"countUser","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"}],"name":"removePetiReg","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"},{"name":"_from","type":"address"},{"name":"_value","type":"uint256"}],"name":"removeToken","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"petiRegister","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"}],"name":"removeAuth","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"}],"name":"hasAddressPetiReg","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"}],"name":"evaluatePeti","outputs":[{"name":"","type":"uint256[3]"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"}],"name":"getPeti","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"}],"name":"numTokens","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"}],"name":"checkPetiReg","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"countPetiReg","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idUser","type":"uint32"}],"name":"hasAddressUser","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idUser","type":"uint32"},{"name":"_address","type":"address"}],"name":"overrideAddressUser","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"},{"name":"_address","type":"address"}],"name":"balanceOfToken","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"getAllAddrPetiReg","outputs":[{"name":"","type":"address[1048576]"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"}],"name":"existsPetiReg","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idUser","type":"uint32"}],"name":"removeUser","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"},{"name":"_address","type":"address"}],"name":"overrideAddressPetiReg","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"},{"name":"_status","type":"bool"}],"name":"setStatusPeti","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"}],"name":"insertPetiReg","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_numVotesPerUser","type":"uint8"},{"name":"_idPeti","type":"uint32"},{"name":"_titlePeti","type":"string"},{"name":"_descriptionPeti","type":"string"},{"name":"_startTimePeti","type":"string"},{"name":"_endTimePeti","type":"string"},{"name":"_userAddresses","type":"address[]"},{"name":"_myToken","type":"address"},{"name":"_myPetition","type":"address"}],"name":"createPetitionToken","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"countAuth","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"},{"name":"_address","type":"address[]"},{"name":"_amount","type":"uint256"}],"name":"initToken","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"}],"name":"insertUser","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"getAllAddrUser","outputs":[{"name":"","type":"address[1048576]"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idPeti","type":"uint32"},{"name":"_choice","type":"uint8"},{"name":"_numVotes","type":"uint8"}],"name":"votePeti","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_idUser","type":"uint32"}],"name":"checkUser","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"}],"name":"existsUser","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"inputs":[{"name":"_petiRegister","type":"address"},{"name":"_userRegister","type":"address"},{"name":"_authRegister","type":"address"}],"payable":false,"type":"constructor"}]';
var controlBytecode = '0x606060405233600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506000600360146101000a81548160ff021916908315150217905550341561006b57600080fd5b604051606080614944833981016040528080519060200190919080519060200190919080519060200190919050505b826000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555081600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001600360146101000a81548160ff0219169083151502179055505b5050505b6147b98061018b6000396000f300606060405236156101cb576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806303cc66c5146101d0578063184b9559146102215780632520e7ff146102985780632912afc9146102e95780634313a2821461034257806345be7ed6146103975780635b57106d146104005780636114059f146104515780636c6f360e146104665780636fafa08a146104bb578063703f5a18146104f057806372d1957a146105195780637b4256081461056a5780637f3fd918146105bf5780638673ee3b146105f85780638a013511146106615780638f5c5c84146106c7578063915bbf231461073057806393026ed51461076d5780639351d373146107ae57806393ec2702146107e3578063949fea651461084c578063a043513214610894578063a823550c146108f0578063b384ce9f14610944578063b578e59d14610995578063b9586160146109be578063b9e4148414610a06578063ba4f50a414610a3a578063ba5808db14610a93578063cc86888314610c52578063d4a1fb5714610c87578063d94eae2214610cf9578063dce1649714610d52578063e2ca51c914610da6578063eb1edbd614610de7578063f409e87d14610e28575b600080fd5b34156101db57600080fd5b61021f600480803563ffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610e79565b005b341561022c57600080fd5b610296600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610f43565b005b34156102a357600080fd5b6102cf600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611083565b604051808215151515815260200191505060405180910390f35b34156102f457600080fd5b610320600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061116d565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b341561034d57600080fd5b61035561135e565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156103a257600080fd5b6103be600480803563ffffffff16906020019091905050611384565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561040b57600080fd5b61044f600480803563ffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050611422565b005b341561045c57600080fd5b6104646115f3565b005b341561047157600080fd5b610479611787565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156104c657600080fd5b6104ce6117ad565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b34156104fb57600080fd5b610517600480803563ffffffff1690602001909190505061185e565b005b341561052457600080fd5b610568600480803563ffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050611a17565b005b341561057557600080fd5b61057d611be8565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156105ca57600080fd5b6105f6600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611c0d565b005b341561060357600080fd5b61061f600480803563ffffffff16906020019091905050611de8565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561066c57600080fd5b610688600480803563ffffffff16906020019091905050611eb1565b6040518082600360200280838360005b838110156106b45780820151818401525b602081019050610698565b5050505090500191505060405180910390f35b34156106d257600080fd5b6106ee600480803563ffffffff16906020019091905050611f59565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561073b57600080fd5b610757600480803563ffffffff16906020019091905050612022565b6040518082815260200191505060405180910390f35b341561077857600080fd5b610794600480803563ffffffff169060200190919050506120c0565b604051808215151515815260200191505060405180910390f35b34156107b957600080fd5b6107c1612189565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b34156107ee57600080fd5b61080a600480803563ffffffff16906020019091905050612239565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561085757600080fd5b610892600480803563ffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050612303565b005b341561089f57600080fd5b6108da600480803563ffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506124f3565b6040518082815260200191505060405180910390f35b34156108fb57600080fd5b6109036125c9565b60405180826210000060200280838360005b838110156109315780820151818401525b602081019050610915565b5050505090500191505060405180910390f35b341561094f57600080fd5b61097b600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061268b565b604051808215151515815260200191505060405180910390f35b34156109a057600080fd5b6109bc600480803563ffffffff16906020019091905050612774565b005b34156109c957600080fd5b610a04600480803563ffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061292e565b005b3415610a1157600080fd5b610a38600480803563ffffffff169060200190919080351515906020019091905050612b1d565b005b3415610a4557600080fd5b610a71600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050612cbd565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b3415610a9e57600080fd5b610c50600480803560ff1690602001909190803563ffffffff1690602001909190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509190803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050612ead565b005b3415610c5d57600080fd5b610c656132ed565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b3415610c9257600080fd5b610cf7600480803563ffffffff169060200190919080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509190803590602001909190505061339e565b005b3415610d0457600080fd5b610d30600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050613585565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b3415610d5d57600080fd5b610d65613776565b60405180826210000060200280838360005b83811015610d935780820151818401525b602081019050610d77565b5050505090500191505060405180910390f35b3415610db157600080fd5b610de5600480803563ffffffff1690602001909190803560ff1690602001909190803560ff16906020019091905050613839565b005b3415610df257600080fd5b610e0e600480803563ffffffff169060200190919050506138e3565b604051808215151515815260200191505060405180910390f35b3415610e3357600080fd5b610e5f600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506139ad565b604051808215151515815260200191505060405180910390f35b6000610e8484611384565b90508073ffffffffffffffffffffffffffffffffffffffff1663a9059cbb84846040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050600060405180830381600087803b1515610f2857600080fd5b6102c65a03f11515610f3957600080fd5b5050505b50505050565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610f9f57600080fd5b826000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555081600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555080600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001600360146101000a81548160ff0219169083151502179055505b5b505050565b6000600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b151561114a57600080fd5b6102c65a03f1151561115b57600080fd5b5050506040518051905090505b919050565b6000600360149054906101000a900460ff16151561118a57600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b151561124f57600080fd5b6102c65a03f1151561126057600080fd5b50505060405180519050151561127557600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663bc902ad2836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b151561133a57600080fd5b6102c65a03f1151561134b57600080fd5b5050506040518051905090505b5b919050565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60008061139083611f59565b90508073ffffffffffffffffffffffffffffffffffffffff1663b03401236000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401602060405180830381600087803b15156113fe57600080fd5b6102c65a03f1151561140f57600080fd5b5050506040518051905091505b50919050565b6000600360149054906101000a900460ff16151561143f57600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b151561150457600080fd5b6102c65a03f1151561151557600080fd5b50505060405180519050151561152a57600080fd5b61153384611384565b90508073ffffffffffffffffffffffffffffffffffffffff1663e30443bc84846040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050600060405180830381600087803b15156115d757600080fd5b6102c65a03f115156115e857600080fd5b5050505b5b50505050565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561164f57600080fd5b611657613a97565b604051809103906000f080151561166d57600080fd5b6000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506116b4613a97565b604051809103906000f08015156116ca57600080fd5b600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550611712613aa7565b604051809103906000f080151561172857600080fd5b600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001600360146101000a81548160ff0219169083151502179055505b5b565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166306661abd6000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401602060405180830381600087803b151561183d57600080fd5b6102c65a03f1151561184e57600080fd5b5050506040518051905090505b90565b600360149054906101000a900460ff16151561187957600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b151561193e57600080fd5b6102c65a03f1151561194f57600080fd5b50505060405180519050151561196457600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1662d84fd8826040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808263ffffffff1663ffffffff168152602001915050600060405180830381600087803b15156119fe57600080fd5b6102c65a03f11515611a0f57600080fd5b5050505b5b50565b6000600360149054906101000a900460ff161515611a3457600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b1515611af957600080fd5b6102c65a03f11515611b0a57600080fd5b505050604051805190501515611b1f57600080fd5b611b2884611384565b90508073ffffffffffffffffffffffffffffffffffffffff1663abe7f1ab84846040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200182815260200192505050600060405180830381600087803b1515611bcc57600080fd5b6102c65a03f11515611bdd57600080fd5b5050505b5b50505050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600360149054906101000a900460ff161515611c2857600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b1515611ced57600080fd5b6102c65a03f11515611cfe57600080fd5b505050604051805190501515611d1357600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166329092d0e826040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050600060405180830381600087803b1515611dcf57600080fd5b6102c65a03f11515611de057600080fd5b5050505b5b50565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632708d68f836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808263ffffffff1663ffffffff168152602001915050602060405180830381600087803b1515611e8e57600080fd5b6102c65a03f11515611e9f57600080fd5b5050506040518051905090505b919050565b611eb9613ab7565b6000611ec483611f59565b90508073ffffffffffffffffffffffffffffffffffffffff16637daa9efc6000604051606001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401606060405180830381600087803b1515611f3257600080fd5b6102c65a03f11515611f4357600080fd5b5050506040518060600160405291505b50919050565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632708d68f836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808263ffffffff1663ffffffff168152602001915050602060405180830381600087803b1515611fff57600080fd5b6102c65a03f1151561201057600080fd5b5050506040518051905090505b919050565b60008061202e83611384565b90508073ffffffffffffffffffffffffffffffffffffffff16638e499bcf6000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401602060405180830381600087803b151561209c57600080fd5b6102c65a03f115156120ad57600080fd5b5050506040518051905091505b50919050565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632b1f2f00836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808263ffffffff1663ffffffff168152602001915050602060405180830381600087803b151561216657600080fd5b6102c65a03f1151561217757600080fd5b5050506040518051905090505b919050565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166306661abd6000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401602060405180830381600087803b151561221857600080fd5b6102c65a03f1151561222957600080fd5b5050506040518051905090505b90565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632708d68f836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808263ffffffff1663ffffffff168152602001915050602060405180830381600087803b15156122e057600080fd5b6102c65a03f115156122f157600080fd5b5050506040518051905090505b919050565b600360149054906101000a900460ff16151561231e57600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b15156123e357600080fd5b6102c65a03f115156123f457600080fd5b50505060405180519050151561240957600080fd5b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16638023b10f83836040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808363ffffffff1663ffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200192505050600060405180830381600087803b15156124d957600080fd5b6102c65a03f115156124ea57600080fd5b5050505b5b5050565b6000806124ff84611384565b90508073ffffffffffffffffffffffffffffffffffffffff166370a08231846000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b15156125a457600080fd5b6102c65a03f115156125b557600080fd5b5050506040518051905091505b5092915050565b6125d1613adf565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663c5ac9a036000604051630200000001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401630200000060405180830381600087803b151561266457600080fd5b6102c65a03f1151561267557600080fd5b5050506040518063020000000160405290505b90565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663f6a3d24e836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b151561275157600080fd5b6102c65a03f1151561276257600080fd5b5050506040518051905090505b919050565b600360149054906101000a900460ff16151561278f57600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b151561285457600080fd5b6102c65a03f1151561286557600080fd5b50505060405180519050151561287a57600080fd5b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1662d84fd8826040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808263ffffffff1663ffffffff168152602001915050600060405180830381600087803b151561291557600080fd5b6102c65a03f1151561292657600080fd5b5050505b5b50565b600360149054906101000a900460ff16151561294957600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b1515612a0e57600080fd5b6102c65a03f11515612a1f57600080fd5b505050604051805190501515612a3457600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16638023b10f83836040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808363ffffffff1663ffffffff1681526020018273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200192505050600060405180830381600087803b1515612b0357600080fd5b6102c65a03f11515612b1457600080fd5b5050505b5b5050565b6000600360149054906101000a900460ff161515612b3a57600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b1515612bff57600080fd5b6102c65a03f11515612c1057600080fd5b505050604051805190501515612c2557600080fd5b612c2e83611f59565b90508073ffffffffffffffffffffffffffffffffffffffff16635c40f6f4836040518263ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018082151515158152602001915050600060405180830381600087803b1515612ca257600080fd5b6102c65a03f11515612cb357600080fd5b5050505b5b505050565b6000600360149054906101000a900460ff161515612cda57600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b1515612d9f57600080fd5b6102c65a03f11515612db057600080fd5b505050604051805190501515612dc557600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663bc902ad2836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b1515612e8957600080fd5b6102c65a03f11515612e9a57600080fd5b5050506040518051905090505b5b919050565b6000808391508173ffffffffffffffffffffffffffffffffffffffff16633e1a771d868d6040518363ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180806020018360ff168152602001828103825284818151815260200191508051906020019060200280838360005b83811015612f495780820151818401525b602081019050612f2d565b505050509050019350505050600060405180830381600087803b1515612f6e57600080fd5b6102c65a03f11515612f7f57600080fd5b5050508290508073ffffffffffffffffffffffffffffffffffffffff166325463c6c8b8b8b8b8b886040518763ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808763ffffffff1663ffffffff168152602001806020018060200180602001806020018673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200185810385528a818151815260200191508051906020019080838360005b838110156130635780820151818401525b602081019050613047565b50505050905090810190601f1680156130905780820380516001836020036101000a031916815260200191505b50858103845289818151815260200191508051906020019080838360005b838110156130ca5780820151818401525b6020810190506130ae565b50505050905090810190601f1680156130f75780820380516001836020036101000a031916815260200191505b50858103835288818151815260200191508051906020019080838360005b838110156131315780820151818401525b602081019050613115565b50505050905090810190601f16801561315e5780820380516001836020036101000a031916815260200191505b50858103825287818151815260200191508051906020019080838360005b838110156131985780820151818401525b60208101905061317c565b50505050905090810190601f1680156131c55780820380516001836020036101000a031916815260200191505b509a5050505050505050505050600060405180830381600087803b15156131eb57600080fd5b6102c65a03f115156131fc57600080fd5b5050506000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663bc902ad2826000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b15156132c357600080fd5b6102c65a03f115156132d457600080fd5b50505060405180519050505b5050505050505050505050565b6000600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166306661abd6000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401602060405180830381600087803b151561337d57600080fd5b6102c65a03f1151561338e57600080fd5b5050506040518051905090505b90565b6000600360149054906101000a900460ff1615156133bb57600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b151561348057600080fd5b6102c65a03f1151561349157600080fd5b5050506040518051905015156134a657600080fd5b6134af84611384565b90508073ffffffffffffffffffffffffffffffffffffffff16633e1a771d84846040518363ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001838152602001828103825284818151815260200191508051906020019060200280838360005b838110156135445780820151818401525b602081019050613528565b505050509050019350505050600060405180830381600087803b151561356957600080fd5b6102c65a03f1151561357a57600080fd5b5050505b5b50505050565b6000600360149054906101000a900460ff1615156135a257600080fd5b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632520e7ff336000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b151561366757600080fd5b6102c65a03f1151561367857600080fd5b50505060405180519050151561368d57600080fd5b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663bc902ad2836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b151561375257600080fd5b6102c65a03f1151561376357600080fd5b5050506040518051905090505b5b919050565b61377e613adf565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663c5ac9a036000604051630200000001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401630200000060405180830381600087803b151561381257600080fd5b6102c65a03f1151561382357600080fd5b5050506040518063020000000160405290505b90565b600061384484611f59565b90508073ffffffffffffffffffffffffffffffffffffffff1663df49c4de84846040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808360ff1660ff1681526020018260ff1660ff16815260200192505050600060405180830381600087803b15156138c857600080fd5b6102c65a03f115156138d957600080fd5b5050505b50505050565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632b1f2f00836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808263ffffffff1663ffffffff168152602001915050602060405180830381600087803b151561398a57600080fd5b6102c65a03f1151561399b57600080fd5b5050506040518051905090505b919050565b6000600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663f6a3d24e836000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050602060405180830381600087803b1515613a7457600080fd5b6102c65a03f11515613a8557600080fd5b5050506040518051905090505b919050565b60405161083880613b2383390190565b6040516104338061435b83390190565b6060604051908101604052806003905b6000815260200190600190039081613ac75790505090565b63020000006040519081016040528062100000905b600073ffffffffffffffffffffffffffffffffffffffff16815260200190600190039081613af4579050509056006060604052341561000f57600080fd5b5b6108198061001f6000396000f3006060604052361561008b576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168062d84fd81461009057806306661abd146100b95780632708d68f146100ee5780632b1f2f00146101575780638023b10f14610198578063bc902ad2146101e0578063c5ac9a0314610239578063f6a3d24e1461028d575b600080fd5b341561009b57600080fd5b6100b7600480803563ffffffff169060200190919050506102de565b005b34156100c457600080fd5b6100cc6103d6565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b34156100f957600080fd5b610115600480803563ffffffff169060200190919050506103ec565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561016257600080fd5b61017e600480803563ffffffff1690602001909190505061041f565b604051808215151515815260200191505060405180910390f35b34156101a357600080fd5b6101de600480803563ffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061044a565b005b34156101eb57600080fd5b610217600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506104dd565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b341561024457600080fd5b61024c61063e565b60405180826210000060200280838360005b8381101561027a5780820151818401525b60208101905061025e565b5050505090500191505060405180910390f35b341561029857600080fd5b6102c4600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061078a565b604051808215151515815260200191505060405180910390f35b6000600160008060008563ffffffff1663ffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555060008060008363ffffffff1663ffffffff16815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b50565b600260009054906101000a900463ffffffff1681565b60006020528060005260406000206000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000600260009054906101000a900463ffffffff1663ffffffff168263ffffffff161090505b919050565b600260009054906101000a900463ffffffff1663ffffffff168263ffffffff161115156104d357806000808463ffffffff1663ffffffff16815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506104d8565b600080fd5b5b5050565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff161561053657600080fd5b81600080600260009054906101000a900463ffffffff1663ffffffff1663ffffffff16815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060018060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506002600081819054906101000a900463ffffffff168092919060010191906101000a81548163ffffffff021916908363ffffffff16021790555090505b919050565b6106466107aa565b6000806106516107aa565b60009250600091505b600260009054906101000a900463ffffffff1663ffffffff168363ffffffff1610156107805760008060008563ffffffff1663ffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141515610773576000808463ffffffff1663ffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16818363ffffffff16621000008110151561073357fe5b602002019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505081806001019250505b828060010193505061065a565b8093505b50505090565b60016020528060005260406000206000915054906101000a900460ff1681565b63020000006040519081016040528062100000905b600073ffffffffffffffffffffffffffffffffffffffff168152602001906001900390816107bf57905050905600a165627a7a72305820ea74b7a1f383ae4452283daffe1600bf01865e12b2a9bae0003648bd73c055f300296060604052341561000f57600080fd5b5b60016000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055505b5b6103bb806100786000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306661abd1461005f5780632520e7ff1461009457806329092d0e146100e5578063bc902ad21461011e575b600080fd5b341561006a57600080fd5b610072610177565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b341561009f57600080fd5b6100cb600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061018d565b604051808215151515815260200191505060405180910390f35b34156100f057600080fd5b61011c600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506101ad565b005b341561012957600080fd5b610155600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061029c565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b600160009054906101000a900463ffffffff1681565b60006020528060005260406000206000915054906101000a900460ff1681565b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16151561020457600080fd5b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506001600081819054906101000a900463ffffffff16809291906001900391906101000a81548163ffffffff021916908363ffffffff160217905550505b5b50565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615156102f557600080fd5b60016000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506001600081819054906101000a900463ffffffff168092919060010191906101000a81548163ffffffff021916908363ffffffff16021790555090505b5b9190505600a165627a7a72305820442bdfdc34adae337ee58683cc4aa0d5251790d881160d4406636c99e4b82c760029a165627a7a72305820ed62e3efb7bf4a5ce68ef01d35b4b9123a138a2b89408d4fef4fdbfd374e74730029';
var controlCon = web3.eth.contract(JSON.parse(controlABI));

var regABI = '[{"constant":false,"inputs":[{"name":"_id","type":"uint32"}],"name":"remove","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"count","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint32"}],"name":"hasAddress","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_id","type":"uint32"}],"name":"check","outputs":[{"name":"contained","type":"bool"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_id","type":"uint32"},{"name":"_address","type":"address"}],"name":"overrideAddress","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"}],"name":"insert","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"getAllAddr","outputs":[{"name":"","type":"address[1048576]"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"exists","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"}]';
var regBytecode = '0x6060604052341561000f57600080fd5b5b6108198061001f6000396000f3006060604052361561008b576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168062d84fd81461009057806306661abd146100b95780632708d68f146100ee5780632b1f2f00146101575780638023b10f14610198578063bc902ad2146101e0578063c5ac9a0314610239578063f6a3d24e1461028d575b600080fd5b341561009b57600080fd5b6100b7600480803563ffffffff169060200190919050506102de565b005b34156100c457600080fd5b6100cc6103d6565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b34156100f957600080fd5b610115600480803563ffffffff169060200190919050506103ec565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561016257600080fd5b61017e600480803563ffffffff1690602001909190505061041f565b604051808215151515815260200191505060405180910390f35b34156101a357600080fd5b6101de600480803563ffffffff1690602001909190803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061044a565b005b34156101eb57600080fd5b610217600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506104dd565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b341561024457600080fd5b61024c61063e565b60405180826210000060200280838360005b8381101561027a5780820151818401525b60208101905061025e565b5050505090500191505060405180910390f35b341561029857600080fd5b6102c4600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061078a565b604051808215151515815260200191505060405180910390f35b6000600160008060008563ffffffff1663ffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff02191690831515021790555060008060008363ffffffff1663ffffffff16815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b50565b600260009054906101000a900463ffffffff1681565b60006020528060005260406000206000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000600260009054906101000a900463ffffffff1663ffffffff168263ffffffff161090505b919050565b600260009054906101000a900463ffffffff1663ffffffff168263ffffffff161115156104d357806000808463ffffffff1663ffffffff16815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506104d8565b600080fd5b5b5050565b6000600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff161561053657600080fd5b81600080600260009054906101000a900463ffffffff1663ffffffff1663ffffffff16815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060018060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506002600081819054906101000a900463ffffffff168092919060010191906101000a81548163ffffffff021916908363ffffffff16021790555090505b919050565b6106466107aa565b6000806106516107aa565b60009250600091505b600260009054906101000a900463ffffffff1663ffffffff168363ffffffff1610156107805760008060008563ffffffff1663ffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141515610773576000808463ffffffff1663ffffffff16815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16818363ffffffff16621000008110151561073357fe5b602002019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505081806001019250505b828060010193505061065a565b8093505b50505090565b60016020528060005260406000206000915054906101000a900460ff1681565b63020000006040519081016040528062100000905b600073ffffffffffffffffffffffffffffffffffffffff168152602001906001900390816107bf57905050905600a165627a7a72305820535bcd9860b46f137cf31552c0108b20fdee97df278532355a549779443890d20029';
var regCon = web3.eth.contract(JSON.parse(regABI));

var authregABI = '[{"constant":true,"inputs":[],"name":"count","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"isAuth","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"}],"name":"remove","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"}],"name":"insert","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"inputs":[],"payable":false,"type":"constructor"}]';
var authregBytecode = '0x6060604052341561000f57600080fd5b5b60016000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055505b5b6103bb806100786000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306661abd1461005f5780632520e7ff1461009457806329092d0e146100e5578063bc902ad21461011e575b600080fd5b341561006a57600080fd5b610072610177565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b341561009f57600080fd5b6100cb600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061018d565b604051808215151515815260200191505060405180910390f35b34156100f057600080fd5b61011c600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506101ad565b005b341561012957600080fd5b610155600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061029c565b604051808263ffffffff1663ffffffff16815260200191505060405180910390f35b600160009054906101000a900463ffffffff1681565b60006020528060005260406000206000915054906101000a900460ff1681565b6000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16151561020457600080fd5b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506001600081819054906101000a900463ffffffff16809291906001900391906101000a81548163ffffffff021916908363ffffffff160217905550505b5b50565b60008060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff1615156102f557600080fd5b60016000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055506001600081819054906101000a900463ffffffff168092919060010191906101000a81548163ffffffff021916908363ffffffff16021790555090505b5b9190505600a165627a7a72305820e7e7e82b424107ea5ccbc2c98b50bea25e31b6fa5b4c6e8fce8756180cc985ae0029';
var authregCon = web3.eth.contract(JSON.parse(authregABI));

//deploy userReg
web3.personal.unlockAccount(web3.eth.defaultAccount, pwd);
var userReg = regCon.new({data: regBytecode}, function(err1, tmpUser){
  if(!err1) {
    if(!tmpUser.address) {
    } else {
    userReg = tmpUser;
    console.log("Userregister deployed at: " + userReg.address);

      //deploy petReg
      web3.personal.unlockAccount(web3.eth.defaultAccount, pwd);
      var petReg = regCon.new({data: regBytecode}, function(err2, tmpPet){
        if(!err2) {
          if(!tmpPet.address) {
          } else {
          petReg = tmpPet;
          console.log("Petitionregister deployed at: " + petReg.address);

          //deploy authReg
          web3.personal.unlockAccount(web3.eth.defaultAccount, pwd);
          var authReg = authregCon.new({data: authregBytecode}, function(err3, tmpAuth){
            if(!err3) {
              if(!tmpAuth.address) {
              } else {
              authReg = tmpAuth;
              console.log("Authorityregister deployed at: " + authReg.address);

              //deploy control
              web3.personal.unlockAccount(web3.eth.defaultAccount, pwd);
              var control = controlCon.new(
                petReg.address,
                userReg.address,
                authReg.address,
                {data: authregBytecode}, function(err4, tmpCon){
                  if(!err4) {
                    if(!tmpCon.address) {
                    } else {
                      control = tmpCon;
                      console.log("Control contract deployed at: " + control.address);

                      web3.personal.unlockAccount(web3.eth.defaultAccount, pwd);
                      control.init(petReg.address, userReg.address, authReg.address);

                      web3.personal.unlockAccount(web3.eth.defaultAccount, pwd);
                      authReg.insert(control.address);

                      if (control.authRegister() == "0x") {
                        console.log("There was a problem setting the register addresses in the control contract. Try deploying a new one manually in parity or some other way with following parameters for the registers:");
                        console.log("Petition Register: " + petReg.address);
                        console.log("User Register: " + userReg.address);
                        console.log("Authority Register: " + authReg.address);
                        console.log("afterwards set the controlAddr attribute in /javascripts/app.js accordingly");
                        console.log("You also need to insert the control address manually into the authority register");
                        console.log("You can find all necessary ABIs and Bytecodes in the upper section of 'newRegAndControl.js'");
                      } else {
                        console.log("Set the controlAddr attribute in /javascripts/app.js to: " + control.address);
                      }
                    }
                  } else {
                    console.log(err4);
                  }});


              }
            } else {
              console.log(err3);
            }});


          }
        } else {
          console.log(err2);
        }});


    }
  } else {
    console.log(err1);
  }});
